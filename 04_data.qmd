# Data {#sec-data}

In this section, I introduce the cryptocurrency data used in this thesis, the series of filters applied to clean and prepare the dataset, and the summary statistics of the cryptocurrency excess returns. In addition, I show the set of asset-specific characteristics constructed from the cryptocurrency market data, which are used as instruments for latent factor exposures in the IPCA model. Appendix -@sec-app_characteristics provides a detailed description of the characteristics used in the empirical analysis. 

**[++++ ADD SMALL INTRO ABOVE OF RIK FACTORS CREATED ++++]**


The data extraction and pre-processing are primarily conducted in R 4.5.1 [@base], using, among other packages^[See [Appendix -@sec-software] for the full list of software used in the empirical study.], the `tidyverse`  [v. 2.0.0\; @tidyverse]. Additional cleaning steps and visualizations are performed in Python 3.13.5 [@python]. The full reproducible code is available in Appendix -@sec-app_material.  

## Data extraction and sample construction

I collect daily cryptocurrency data on open, high, close, and low (OHCL) prices, 24-hour volume, and market capitalization (calculated as the cryptocurrency's USD price multiplied by its circulating supply) from [CoinCodex](https://coincodex.com/), a website-data provider that gathers and aggregates data from more than 400 exchanges. I extract the data, all expressed in US dollars, using the CoinCodex API as follows: 

1. I retrieve the list of all available cryptocurrencies and extract each cryptocurrency shortname, also referred to as the "slug". At the time of writing, there are 14,907 unique cryptocurrency shortnames listed in the API. 

2. Using the slug, I construct an URL for each cryptocurrency to obtain the metadata from the API. I parse the JSON API response into a dataframe and extract the OHCL prices, volume, and market capitalization daily data. I exclude those observations with non-zero or missing values in any of these fields.  

Out of the 14,907 cryptocurrencies listed, only 7,272 entries contained available data. Next, following the methodology of @bianchiMispricingRiskCompensation2021 and @mercikCrosssectionalInteractionsCryptocurrency2025, I apply a series of cleaning and filtering steps in order to remove possible innacuracies in the dataset: 

1. Non-positive and missing values. As mentioned earlier, I remove observations where prices, volume, or market capitalization were non-positive or missing. 
2. Small cryptocurrencies. Similar to @liuCommonRisk2022, I screen out small cryptocurrencies and consider only those with a market capitalization greater than one million USD. Therefore, I exclude observations for coins whose market capitalization falls below this minimum threshold, which allows for the possibility that a coin may become "small" after a certain period or event. 
3. Cryptocurrency type. Based on the cryptocurrency classification from [CoinMarketCap](https://coinmarketcap.com/cryptocurrency-category/) and CoinCodex, I exclude: 

    - stablecoins.  I include (i) centralized stablecoins, which are backed and pegged to fiat currency or physical assets by a third party, such as Tether (USDT), USD Coin (USDC), and Euro Coin (EURC), and (ii) algorithmically stabilized stablecoins, which use algorithms to adjust the circulating supply in response to changes in demand to maintain a stable value with the underlying asset, such as DAI and AMPL [FSB, -@financialstabilityboardAddressingRegulatory2020].

    - wrapped cryptocurrency tokens, which mirror the value of another cryptocurrency from a different blockchain, e.g., Wrapped Bitcoin (wBTC) or Wrapped Ethereum (wETH) [@coinbaseWhatWrapped]. 
    - cryptocurrencies backed by or pegged to gold or precious metals, including Pax Gold (PAXG) or XAGx Silver Token (XAGX).
    
4. Erroneous trading volume. To filter out cryptocurrencies with "fake" or "erroneous" trading volume, I calculate the daily volume-to-market-capitalization ratio for each token and exclude observations where the ratio exceeds 1.
5. Extreme returns. To minimize the influence of extreme values in my results, I winsorize daily cryptocurrency returns to lie within the range of -90% to 500%.
6. Time period. Even though cryptocurrency data are available since 2014, I use data from June 1, 2018 for the empirical analysis due to the low amount of coins available before this date (see @fig-numcoins). 
7. Minimum observations. In order to maintain practical relevance, I keep cryptocurrencies that have at least 365 consecutive daily observations and those with at least 730 observations in the complete panel of coin characteristics (see @sec-characteristics), which is equivalent to 2 years of historical data. Therefore, I exclude very short-lived coins, but retain failed coins with this relatively large number of observations, which help to lessen the so called "survivorship biais".


::: {#fig-numcoins fig-scap="Number of cryptocurrencies over time"}
<!-- fig-scap="short subcaption 1"  Use this to add a title in LOF for each subplot-->
![](pictures/timeseries_daily_coins.png){#fig-sub1 width=80%}

![](pictures/coins_per_year.png){#fig-sub2 width=80%} 

**Number of cryptocurrencies over time.** Panel A shows the daily time series of the number of unique cryptocurrencies. Panel B displays the number of unique cryptocurrencies recorded each year. Both panels correspond to the dataset after applying the filtering steps (1) to (5), covering the period from January 1, 2014, to July 31, 2025, and including 1,416 unique cryptocurrencies.  Note that coins may enter or exit the market over time. 
:::

## Sample overview

After applying all the filters, the resulting sample consists of 973 unique cryptocurrencies and 1,478,936 observations from June 1, 2018, to July 31, 2025, where a day starts at 00:00:00 UTC. It is important to mention that the number of cryptocurrencies fluctuates over the entire period, which results in an unbalanced panel of data. Table \ref{tbl-cross_section} provides a description of the yearly cross-sectionional statistics: the sample starts with 254 different cryptocurrencies in 2018 and peaks in 2023 with 939 unique cryptocurrencies, before decreasing to 780 in 2025. The minimum daily cross-section is 121 in 2018, and then increases drastically up to 793 in 2023. For context, at the time of writing, CoinMarketCap tracks around 19 million cryptocurrencies, and CoinGecko around 19 thousands. When compared to these numbers, the size of the sample may seem small; however, it actually covers most of the whole cryptocurrency market capitalization (see @fig-samplemarketcap). The sample period includes important events in the market, such as 

Table \ref{tbl-overview} summarizes the descriptive statistics for the cryptocurrency daily returns across different subsamples and Bitcoin, Ethereum, and Ripple, which are the three largest cryptocurrencies in the sample. Interestingly, the larger samples exhibit a larger volatility and more pronounced extreme returns, both positive and negative. Bitcoin shows the lowest mean return during the sample period (0.16% per day), though this value very close to that of Ethereum (0.17%) and Ripple (0.20%), and only slightly below other  cryptocurrency subsamples. 
<!-- Overall, expanding the cross-section increases the dispersion of returns: the top 10 subsample already includes the most popular "meme" coin Dogecoin, and adding more cryptocurrencies introduces assets with a higher volatility.   -->


![**Cryptocurrency market capitalization**. The figure compares the cryptocurrency market capitalization in the filtered sample (blue line) with the total market capitalization (yellow line) from June 1, 2018 to July 31, 2025. Source: total market capitalization from [CoinGecko](https://www.coingecko.com/).](pictures/sample_marketcap.png){#fig-samplemarketcap fig-scap="Cryptocurrency market capitalization" width=80%}



```{=latex}
\begin{table}[t]
\footnotesize
\centering
\caption[Cross-section size of the sample]{\textbf{Cross-section size of the sample.} The table repots the number of unique coins per year, as well as the minimum daily cross-section size in the filtered sample.}
\label{tbl-cross_section}
\begin{tabular}{ccccccccc}
\toprule
Year & 2018 & 2019 & 2020 & 2021 & 2022 & 2023 & 2024 & 2025 \\
\midrule
Unique coins & 254 & 337 & 420 & 714 & 938 & 939 & 906 & 780 \\
Min. daily cross-section & 121 & 239 & 207 & 381 & 699 & 793 & 710 & 578 \\
\bottomrule
\end{tabular}
\end{table}
```


```{=latex}
\begin{table}[t]
\centering
\caption[Summary statistics of daily returns]{\textbf{Summary statistics of daily returns.} The table reports summary statistics of daily returns for the filtered sample, the top 100 and top 10 cryptocurrencies ranked by market capitalization, and for Bitcoin, Ethereum, and Ripple individually. Reported statistics include the number of daily observations, the number of unique coins over the sample period, the mean and standard deviation of returns, and the 10th percentile, lower quartile, median, upper quartile, and 90th percentile of the distribution of the returns. The sample period is from June 1, 2018, to July 31, 2025.}
\label{tbl-overview}
\begin{adjustbox}{max width=\textwidth}
\begin{threeparttable}
\begin{tabular}{lccccccccc}
\toprule
 & No. Obs & Unique coins & Mean & Std & P10 & P25 & P50 & P75 & P90 \\
\midrule
Sample & 1,478,936 & 973 & 0.36\% & 12.25\% & -6.83\% & -3.00\% & -0.16\% & 2.57\% & 6.85\% \\
Top 100 & 176,400 & 100 & 0.21\% & 6.93\% & -5.64\% & -2.52\% & -0.03\% & 2.44\% & 5.86\% \\
Top 10 & 24,747 & 10 & 0.25\% & 5.74\% & -4.71\% & -2.00\% & 0.07\% & 2.14\% & 5.07\% \\
Bitcoin & 2,618 & 1 & 0.16\% & 3.33\% & -3.24\% & -1.27\% & 0.09\% & 1.52\% & 3.67\% \\
Ethereum & 2,611 & 1 & 0.17\% & 4.35\% & -4.33\% & -1.77\% & 0.10\% & 2.14\% & 4.88\% \\
Ripple & 2,540 & 1 & 0.20\% & 5.31\% & -4.48\% & -1.87\% & 0.08\% & 1.89\% & 4.70\% \\
\bottomrule
\end{tabular}
\begin{tablenotes}\footnotesize
\item[1] As of July 31, 2025, the top 10 cryptocurrencies are Bitcoin, Ethereum, Ripple, Binance Coin, Solana, Dogecoin, Tron, Cardano, Stellar, and Chainlink.
\end{tablenotes}
\end{threeparttable}
\end{adjustbox}
\end{table}
```


The sample period spans several major market, economic, and political events, these include: the start of the COVID-19 pandemic and the subsequent crypto bubble in 2020-2021, El Salvador adoption of Bitcoin as legal tender in September 2021, and China's ban on cryptocurrency exchanges and mining in October 2021. The period also experienced multiple cryptocurrency exchange hacks^[For example, Binance, largest crypto exchange in the world, was hacked in 2019, and KuCoin and Crypto.com were hacked in 2020 and 2022, respectively. [@zhouApplicationEvent2025]], and geopolitical shocks such as the Russia-Ukraine war in February 2022, and the Palestine-Israel war in October 2023. More recently, in 2024, the U.S. Secutities and Exchange Commission (SEC) approved the listing and trading of several crypto spot ETFs in January, and Donald Trump's election as U.S. president, with Elon Musk playing and important role in his campaign [@liuSpotCryptocurrency2024; @mercikCrosssectionalInteractionsCryptocurrency2025; @bianchiMispricingRiskCompensation2021; @chenHowEffective2022; @zhouApplicationEvent2025]. 

## Characteristic construction and description {#sec-characteristics}

For the analysis, I construct 41 asset-specific characteristics from the cross-section of 973 cryptocurrencies using data on prices, volume, and market capitalization. Specifically, I follow the methodology of @bianchiMispricingRiskCompensation2021, @liuCommonRisk2022, and @mercikCrosssectionalInteractionsCryptocurrency2025 to replicate and classify a set of characteristics that serve as return predictors in the empirical analysis. Based on economic intuition, I group the characteristics into six categories: market and size, volatility and risk, trading activity, liquidity, past returns, and distribution. Table \ref{tbl-characteristics} summarizes the set of characteristics, while Appendix XXX provides a detailed description and the construction procedure.   


```{r}
#| echo: FALSE
#| warning: FALSE 
#| message: FALSE
##| label: tbl-characteristics

library(dplyr)
library(stringr)
library(kableExtra)

# ---- your groups ----
panels <- list(
  core          = c("mcap","prc", "dh90"),
  volrisk       = c("beta","ivol", "rvol_7d", "rvol_30d", "retvol","var","delay"),
  activity      = c("volume", "volume_7d", "volume_30d", "volscaled","turn","std_vol","cv_vol"),
  liquidity     = c("bidask","illiq","sat","dto","volsh_30d"),
  past_returns  = c("r2_1","r7_1", "r14_1","r21_1","r30_1","r30_14", 
                    "r180_60","dh90","alpha"),
  distribution  = c("skew","kurt","maxret","minret")
)

panel_titles <- c(
  core         = "Price and size",
  volrisk      = "Volatility & risk",
  activity     = "Activity",
  liquidity    = "Liquidity",
  past_returns = "Past returns",
  distribution = "Distribution"
)

definitions <- tribble(
  ~No,   ~Symbol,       ~Characteristic,              ~Definition,
  # ---- Price and Size ----
  "(1)",    "mcap",        "Market capitalization",      "Market capitalization of the coin.",
  "(2)",    "prc",         "Price",                      "Cryptocurrency logged closing price.",
  "(3)",    "dh90",        "Closeness to the 90-day high", "Last day's price over the maximum price in the previous 90 days.",

  # ---- Volatility & Risk ----
  "(4)",   "beta",        "Market beta",                "CAPM market beta, estimated from 30 days of daily returns.",
  "(5)",   "ivol",        "Idiosyncratic volatility",   "Volatility of CAPM residuals over 30 days of daily returns.",
  "(6)",   "rvol_7d",     "7-day realized volatility",  "Realized volatility, calculated from 7 days of OHCL prices.",
  "(7",    "rvol_30d",    "30-day realized volatility", "Realized volatility, calculated from 30 days of OHCL prices.",
  "(8)",   "retvol",      "Return volatility",          "Standard deviation of daily returns over 7 days.",
  "(9)",   "var",         "Value-at-Risk",              "The historical Value-at-Risk at 5\\% level over 90 days.",
  "(10)",  "es_5",        "Expected Shortfall",         "The expected shortfall at the 5\\% level over 90 days.",
  "(11)",   "delay",       "Price delay",                "Improvement in \\(R^2\\) after adding lagged one-and two-day market excecss return to the CAPM.",

  # ---- Trading activity ----
  "(12)",   "volume",      "Trading volume",                     "Last day's daily trading volume.",
  "(13)",   "volume_7d",   "Average 7-day volume",       "Mean volume over the past 7 days.",
  "(14)",   "volume_30d",  "Average 30-day volume",      "Mean volume over the past 30 days.",
  "(15)",   "turn",        "Turnover",                   "The last day's trading volume over last day's market capitalization",
  "(16)",   "turn_7d",     "Average 7-day turnover",     "Mean turnover over the past 7 days",
  "(17)",   "std_turn",    "Turnover volatility",        "Turnover volatility over the past 30 days",
  "(18)",   "std_vol",    "Trading volume volatility",  "Volume's logged volatility over the past 30 days",
  "(19)",   "cv_vol",      "Volume's coefficient of variation",    "Volume's volatility over its mean in the previous 30 days",

  # ---- Liquidity ----
  "(20)",   "bidask",      "Bid-ask spread",             "Mean estimated bid-ask spread calculated over the past 30 days.",
  "(21)",   "illiq",       "Illiquidity",                "Mean absolute daily return over trading volume over the past 30 days.",
  "(22)",   "sat",         "Supply-adjusted turnover",   "lag turn - average over its volatility",
  "(23)",   "dto",         "Dollar trading output",      "Total dollar trading value.",
  "(24)",   "volsh_15d",   "30-day volume share",        "Share of trading volume in the past 30 days.",
  "(25)",   "volsh_30d",   "30-day volume share",        "Share of trading volume in the past 30 days.",

  # ---- Past Returns ----
  "(26)",    "r2_1",        "Daily reversal",             "Return on the previous trading day.",
  "(27-30)", "r7_1",        "*-day momentum",             "7, 14, 21, and 30-day cumulative return ending 1 day before the prediction date.",
  "(31)",    "r30_14",      "Intermediate momentum",         "Cumulative return from 30 to 14 days before the prediction date.",
  "(32)",    "r180_60",     "Long-term reversal",        "Cumulative return from 180 to 60 days before the prediction date.",
  "(33)",    "alpha",       "CAPM alpha",             "Jensenâ€™s alpha estimated from a factor model.",

  # ---- Distribution ----
  "(34-35)",    "skew_*d",     "Skewness",            "Skewness of daily returns over a 90-day period.",
  "(36-37)",    "kurt_*d",     "Kurtosis",            "Kurtosis of daily returns over a 90-day period.",
  "(38-39)",    "maxret_*d",   "Maximum daily return",             "Maximum daily return in the sample.",
  "(40-41)",   "minret_*d",   "Minimum daily return",             "Minimum daily return in the sample."
)

# ---- build table ----
tbl <- bind_rows(lapply(names(panels), function(p) {
  tibble(
    Panel  = p,
    Symbol = panels[[p]]
  )
})) |>
  left_join(definitions, by = "Symbol") |> 
  group_by(Panel) |>
  ungroup() |>
  mutate(
    PanelLabel = paste0(
      "Panel ", LETTERS[match(Panel, names(panels))], ": ",
      panel_titles[Panel]
    )
  )

tbl <- tbl %>%
     mutate(Symbol = gsub("_", "\\\\_", Symbol))  # replace _ with \_

# ---- render ----
k <- kbl(
  tbl %>% select(No, Characteristic, Symbol, Definition),
  booktabs = TRUE,
  #longtable = TRUE,
  #format = "latex",
  escape = FALSE,
  align = "llll",
  caption = "\\textbf{Cryptocurrency characteristics.} This caption is way too long and doesnt look good when formatted in the Table of Contents.  What you really need here is a much shorter caption so that your eyes dont go crazy trying to figure out what information the author is trying to convey.  Often there is too much information in the caption anyway so why not shorten it?. \\label{tbl-characteristics}",
  caption.short = "Cryptocurrency characteristics.",
  col.names = c("No.", "Characteristic", "Symbol", "Definition")
) |>
  kable_styling(full_width = F, font_size = 8.5) |>
  column_spec(2, width = "10em") |>
  column_spec(4, width = "26em") 

# add grouped rows for panels
for (p in unique(tbl$PanelLabel)) {
  nrows <- sum(tbl$PanelLabel == p)
  start <- which(tbl$PanelLabel == p)[1]
  end   <- start + nrows - 1
  k <- k %>% group_rows(p, start, end)
}

k

```





This is more related to factor construction. 

Organize week in the following way: the first seven days of the year forms the first week, and the first 51 weeks of the year consists of 7 days each. The 52th week of the year consists of the last eight days and, in case of a leap year (as 2016, 2020, and 2024), of nine days. 

Following @liuCommonRisk2022, I construct a daily cryptocurrency market return as the value-weighted average return of all the cryptocurrencies in the sample. For cryptocurrencies $i = 1, ..., N$, the daily market return at time $t$ is computed as: 

$$
r_t^M = \frac{\sum_{i=1}^N r_{it} \cdot marketcap_{it}}
             {\sum_{i=1}^N marketcap_{it} }
$$

The cryptocurrency market excess return is constructed as the difference between the cryptocurrency market return and the risk-free rate. To proxy the risk-free rate, I used the (daily) 1-month Treasury bill rate from the FRED. 



Write this in the following section of "Empirical application" or 
This is for the model:
7. (Still undecisive) Minimum cross-section. Following the criterion by Kelly, I 
Convert variables in the -0.5 - 0.5 range
    
The sample period ranges from January 1st, 2014, to May 31st, 2025.  
